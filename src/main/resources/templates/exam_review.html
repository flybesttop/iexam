<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>IEXAM</title>

    <!--<link th:href="@{/css/iexam/scrollbar.css}" rel="stylesheet">-->
    <link rel="stylesheet" th:href="@{/fontAwesome/css/all.css}">
    <link rel="stylesheet" th:href="@{/fontAwesome/css/v4-shims.css}">
    <!-- Bootstrap core CSS -->
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link th:href="@{/css/mdb.min.css}" rel="stylesheet">

    <!-- Your custom styles (optional) -->
    <link th:href="@{/css/addonss/bootstrap-table.min.css}" rel="stylesheet">

    <link th:href="@{/css/iexam/emmo_Apparence.css}" rel="stylesheet">

    <link th:href="@{/css/iexam/bootoast.css}" rel="stylesheet">
    <link th:href="@{/css/addonss/bootstrap-datetimepicker.min.css}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/animate.css@3.5.1" rel="stylesheet" type="text/css">

    <style type="text/css">

    </style>
</head>

<body class="post-page">
<div id="app">
    <div class="d-none" id="userId" th:data="${session.BACKSYS_USER.id}"></div>
    <main>
        <div class="container-fluid">
            <div class="row">
                <div class="col card">
                    <!-- Material auto-sizing form -->
                    <form>
                        <!-- Grid row -->
                        <div class="form-row align-items-center">
                            <!-- Grid column -->
                            <div class="col-auto">
                                <div class="md-form input-group mb-3">
                                    <div class="input-group-prepend mr-5">
                                        <span style="font-size: 24px;" class="input-group-text md-addon">阅卷信息</span>
                                    </div>
                                    <!--<input type="text" class="form-control pl-0 rounded-0" id="yuejuanchaxun"-->
                                           <!--placeholder="关键字查询">-->
                                </div>
                            </div>
                            <!--<div class="col-auto">-->
                                <!--<button type="submit" class="btn btn-primary mb-0">查找</button>-->
                            <!--</div>-->
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="col card">
                    <table class="table text-center">
                        <thead class="lighten-2">
                        <tr>
                            <th scope="col">考试名称</th>
                            <th scope="col">职称</th>
                            <th scope="col">阅卷开始时间</th>
                            <th scope="col">阅卷结束时间</th>
                            <th scope="col">阅卷考场</th>
                            <th scope="col">状态</th>
                            <th scope="col">操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr v-for="(item,index) in exam.exams">
                            <td>
									<span class="d-inline-block text-truncate" style="max-width: 150px;" title="软件工程">
									  {{item.exam.name}}
									</span>
                            </td>
                            <td>
									<span class="d-inline-block text-truncate" style="max-width: 150px;" title="初级设计师">
									  {{item.exam.titleName}}
									</span>
                            </td>
                            <td v-text="item.exam.reviewStartTime"></td>
                            <td v-text="item.exam.reviewEndTime"></td>
                            <td>
                                <ul style="list-style: none">
                                    <li v-for="(item2,index) in item.examRoomList">
                                        {{item2.no}}号考场 - {{item2.roomName}}
                                    </li>
                                </ul>
                            </td>
                            <td>
                                <span class="text-warning" v-if="item.exam.status==='5'">未开始</span>
                                <span class="text-warning" v-if="item.exam.status==='4'">未开始</span>
                                <span class="text-warning" v-if="item.exam.status==='6'">未开始</span>
                                <span class="text-warning" v-if="item.exam.status==='7'">未开始</span>
                                <span class="text-danger" v-if="item.exam.status==='8'">进行中</span>
                                <span v-if="item.exam.status>'8'">已结束</span>
                                <span v-if="item.exam.status==='10'">已结束</span>
                            </td>
                            <td class="px-0 mx-0">
                                <div class="btn-group px-0 mx-0" role="group" aria-label="Basic example">
                                    <button type="button" v-if="item.exam.status==='8'"
                                            class=" btn btn-sm btn-outline-deep-purple btn-rounded waves-effect" @click="chooseExam(index)" data-toggle="modal" data-target="#exampleModalCenter">
                                        上传成绩
                                    </button>
                                    <button type="button" v-if="item.exam.status>'8'"
                                            class=" btn btn-sm btn-outline-deep-purple btn-rounded waves-effect" @click="chooseExam(index)" data-toggle="modal" data-target="#exampleModalCenter">
                                        查看成绩
                                    </button>
                                    <button type="button" data-toggle="modal" data-target="#iexam_info_model" @click="openExamDetail(item.exam)"
                                            class=" btn btn-sm btn-outline-deep-purple btn-rounded waves-effect">考试详情
                                    </button>
                                </div>
                            </td>
                        </tr>

                        </tbody>
                    </table>

                    <div class="md-form input-group d-flex justify-content-center">
                        <div class="input-group-prepend">
                            <button class="pages-first btn btn-md btn-primary m-0 px-3" type="button" id="examPrevStart"
                                    @click="examPrevStart"><i
                                    class="fas fa-angle-double-left"></i></button>
                            <button class="pages-prev btn btn-md btn-primary m-0 px-3" type="button" id="examPrev"
                                    @click="examPrev"><i
                                    class="fas fa-angle-left"></i></button>
                        </div>
                        <input type="text" class="form-control text-center col-4 pages-active" id="examPage"
                               @onfocus="examPageFocus" @onblur="examPageFocusOut" @onkeyup="examPageKeyUp"
                               :value="exam.page.showtext">
                        <div class="input-group-append">
                            <button class="pages-next btn btn-md btn-primary m-0 px-3" type="button" id="examNext"
                                    @click="examNext"><i
                                    class="fas fa-angle-right"></i></button>
                            <button class="pages-last btn btn-md btn-primary m-0 px-3" type="button" id="examNextTop"
                                    @click="examNextTop"><i
                                    class="fas fa-angle-double-right"></i></button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>
    <div class="modal fade top" id="exampleModalCenter" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle"
         aria-hidden="true">

        <!-- Add .modal-dialog-centered to .modal-dialog to vertically center the modal -->
        <div class="modal-dialog modal-full-height modal-top" role="document">


            <div class="modal-content">
                <div class="modal-header">
                    <div class="col-10">
                        <div class="md-form input-group mb-3 ">
                            <div class="input-group-prepend mr-5">
                                <span style="font-size: 24px;" class="input-group-text md-addon">成绩上传</span>
                            </div>
                            <input type="text" class="form-control pl-0 rounded-0" id="kaoshengchaxun"
                                   placeholder="准考证号">
                            <button type="button" class="btn btn-primary mb-0">查找</button>

                            <select class="browser-default custom-select mb-0 mt-2 offset-2" @change="changeRoom"
                                    v-model="nowchooseRoom">
                                <option :value="item.id"  v-for="(item,index) in nowchooseExam.examRoomList">
                                    {{item.no}}号考场-{{item.roomName}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">

                        <div class="row">
                            <div class="col card">
                                <table class="table text-center">
                                    <thead class="lighten-2">
                                    <tr>
                                        <th scope="col">考生准考证号</th>
                                        <th scope="col">考生成绩</th>

                                        <th scope="col" class="w-25">操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="(item,index) in examiness.examinesses">
                                        <td v-text="item.ticketNumber"></td>
                                        <td>
                                            <input type="number" style="width: 120px" :class="['gradeInput','mx-auto','form-control','pl-1','rounded-1',{'d-none':item.status===1}]" v-model="item.grade" placeholder="考生成绩">
                                            <span :class="[{'d-none':item.status===0},'grade']" v-text="item.grade">1</span>
                                        </td>
                                        <td>

                                            <button type="button" :class="[{'d-none':item.status===0},'btn','btn-outline-primary','btn-sm','m-0','waves-effect']" :data="item.id" onclick="shouGardeEdit(this)">修改成绩
                                            </button>
                                            <button type="button"  :class="[{'d-none':item.status===1},'btn','btn-outline-danger','btn-sm','m-0','waves-effect']" :data="item.id" onclick="doneGrade(this)">完成
                                            </button>

                                        </td>
                                    </tr>

                                    </tbody>
                                </table>


                                <div class="md-form input-group d-flex justify-content-center">
                                    <div class="input-group-prepend">
                                        <button class="pages-first btn btn-md btn-primary m-0 px-3" type="button" id="examinessPrevStart"
                                                @click="examinessPrevStart"><i
                                                class="fas fa-angle-double-left"></i></button>
                                        <button class="pages-prev btn btn-md btn-primary m-0 px-3" type="button" id="examinessPrev"
                                                @click="examinessPrev"><i
                                                class="fas fa-angle-left"></i></button>
                                    </div>
                                    <input type="text" class="form-control text-center col-4 pages-active" id="examinessPage"
                                           @onfocus="examinessPageFocus" @onblur="examinessPageFocusOut" @onkeyup="examinessPageKeyUp"
                                           :value="examiness.page.showtext">
                                    <div class="input-group-append">
                                        <button class="pages-next btn btn-md btn-primary m-0 px-3" type="button" id="examinessNext"
                                                @click="examinessNext"><i
                                                class="fas fa-angle-right"></i></button>
                                        <button class="pages-last btn btn-md btn-primary m-0 px-3" type="button" id="examinessNextTop"
                                                @click="examinessNextTop"><i
                                                class="fas fa-angle-double-right"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade top " id="iexam_info_model" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">

        <!-- Add class .modal-full-height and then add class .modal-right (or other classes from list above) to set a position to the modal -->
        <div class="modal-dialog modal-full-height modal-top" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="myModalLabel2">考试当前状态：{{NowEditExamInfo.status | examStatus}}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="container" style="background-color: white;margin-top: -6px;">
                        <main>
                            <div>
                                <!-- Section: Blog v.4 -->
                                <section class="mt-2 pb-3 wow fadeIn">
                                    <!-- Grid row -->
                                    <div class="row">
                                        <!-- Grid column -->
                                        <div class="col-md-12">
                                            <!-- Featured image -->
                                            <div class="justify-content-between d-flex">
                                                <div class="mt-3 card p-3 col-12">
                                                    <!-- Section: exams -->
                                                    <section class="section card-body">
                                                        <div class="container col-12">
                                                            <div class="row mb-1">
                                                                <div class="d-none" id="examId"
                                                                     v-text="NowEditExamInfo.id"></div>
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试名：
                                                                </div>
                                                                <div class="col-7 attrubute_Content"
                                                                     v-text="NowEditExamInfo.name"></div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="d-none" id="titleName"
                                                                     v-text="NowEditExamInfo.id"></div>
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    职称：
                                                                </div>
                                                                <div class="col-7 attrubute_Content"
                                                                     v-text="NowEditExamInfo.titleName"></div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    报名时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content">
                                                                    <span v-text="NowEditExamInfo.registrationStartTime"></span>
                                                                    ~ <span
                                                                        v-text="NowEditExamInfo.registrationFinishTime"></span>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试安排截至时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content"
                                                                     v-text="NowEditExamInfo.ticketGenerateTime"></div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    获取准考证时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content"
                                                                     v-text="NowEditExamInfo.ticketPublicizeTime"></div>
                                                            </div>

                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content">
                                                                    <span v-text="NowEditExamInfo.examinationStartTime"></span>
                                                                    ~ <span
                                                                        v-text="NowEditExamInfo.examinationEndTime"></span>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    阅卷时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content">
                                                                    <span v-text="NowEditExamInfo.reviewStartTime"></span>
                                                                    ~ <span
                                                                        v-text="NowEditExamInfo.reviewEndTime"></span>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    成绩获取时间：
                                                                </div>
                                                                <div class="col-7  attrubute_Content"
                                                                     v-text="NowEditExamInfo.gradePublicizeTime"></div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试地点：
                                                                </div>
                                                                <div class="col-7  attrubute_Content"
                                                                     v-text="NowEditExamInfo.place"></div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    报名费用：
                                                                </div>

                                                                <div class="col-7  attrubute_Content"><span
                                                                        v-text="NowEditExamInfo.examFee"></span>￥
                                                                </div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    报名人数：
                                                                </div>
                                                                <div class="col-7  attrubute_Content">
                                                                    <span v-text="NowEditExamInfo.num"></span>/
                                                                    <span v-text="NowEditExamInfo.capacity"></span>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试分数：
                                                                </div>
                                                                <div class="col-7  attrubute_Content">
                                                                    满分：<span v-text="NowEditExamInfo.maxGrade"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                    通过分数：<span v-text="NowEditExamInfo.passGrade"></span>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-1">
                                                                <div class="offset-1 col-3 font-weight-bolder attribute_Name">
                                                                    考试说明：
                                                                </div>

                                                                <p class="col-7 attrubute_Content"
                                                                   v-text="NowEditExamInfo.comment"></p>
                                                            </div>
                                                            <hr>
                                                            <div class="row">
                                                                <div class="col-10 offset-1">
                                                                    <div class="font-weight-bolder attribute_Name">
                                                                        注意事项：
                                                                    </div>
                                                                    <p v-text="NowEditExamInfo.precautions"></p>
                                                                </div>
                                                            </div>
                                                            <hr>
                                                            <div class="row">

                                                                <div class="col-10 offset-1">
                                                                    <h5 class="my-3 text-lg-left "><i
                                                                            class="fas fa-link"></i> 相关链接：</h5>
                                                                    <ol>
                                                                        <li v-for="(item,index) in file_links">
                                                                            <p><a :href="item.titlePath"><i
                                                                                    class="far fa-file-alt"></i> <span
                                                                                    v-text="item.fileTitle"></span></a>
                                                                            </p>
                                                                        </li>
                                                                    </ol>

                                                                </div>

                                                            </div>
                                                            <hr>
                                                            <div class="row"
                                                                 v-if="NowEditExamInfo.status>4||NowEditExamInfo.status==='10'">

                                                                <div class="col-10 offset-1">
                                                                    <h5 class="my-3 text-lg-left "><i
                                                                            class="fas fa-link"></i> 考试安排详情：</h5>
                                                                    <table class="table text-center">
                                                                        <thead class="lighten-2">
                                                                        <tr>
                                                                            <th scope="col">考场</th>
                                                                            <th scope="col">考场容量</th>
                                                                            <th scope="col">相关监考</th>
                                                                            <th scope="col">对应阅卷</th>
                                                                            <th scope="col">操作</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        <tr v-for="(item,index) in arrangeMessage">
                                                                            <td>
                                                                                <span v-text="item.examRoom.no"></span>号考场
                                                                                - <span
                                                                                    v-text="item.examRoom.roomName"></span>
                                                                            </td>
                                                                            <td v-text="item.examRoom.capacity"></td>
                                                                            <td>
                                                                                <ul style="list-style: none">
                                                                                    <li v-text="item1.realName"
                                                                                        v-for="item1 in item.invigilatorList"></li>
                                                                                </ul>
                                                                            </td>
                                                                            <td v-text="item.reviewer.realName"></td>

                                                                            <td class="px-0 mx-0">
                                                                                <div class="btn-group px-0 mx-0"
                                                                                     role="group"
                                                                                     aria-label="Basic example">
                                                                                    <button type="button"
                                                                                            class=" btn btn-sm btn-outline-deep-purple btn-rounded waves-effect"
                                                                                            @click="getAllStdTicket(item.examRoom.id)">
                                                                                        获取考生信息
                                                                                    </button>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </section>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        </main>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>








<script type="text/javascript" th:src="@{/js/jquery-3.3.1.min.js}" src="/js/jquery-3.3.1.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" th:src="@{/js/Vue/vue.js}"></script>
<script type="text/javascript" th:src="@{/js/popper.min.js}" src="/js/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" th:src="@{/js/bootstrap.js}" src="/js/bootstrap.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" th:src="@{/js/mdb.min.js}" src="/js/mdb.min.js"></script>

<script type="text/javascript" th:src="@{/js/addons/bootstrap-table.min.js}"
        src="/js/addons/bootstrap-table.min.js"></script>
<script type="text/javascript" th:src="@{/js/addons/bootstrap-table-locale-all.js}"
        src="/js/addons/bootstrap-table-locale-all.js"></script>

<script type="text/javascript" th:src="@{/js/iexam/bootoast.js}"></script>

<script type="text/javascript" th:src="@{/js/iexam/emmo_backTable_basicOperator.js}"></script>

<script type="text/javascript" th:src="@{/js/Vue/IexamBack/backTemplates.js}"></script>

<script type="text/javascript">

    function shouGardeEdit(e) {
        $(e).parent().parent().find(".gradeInput").removeClass("d-none");
        $(e).parent().parent().find(".gradeInput").next().addClass("d-none");
        $(e).addClass("d-none");
        $(e).next().removeClass("d-none");
    }
    
    function doneGrade(e) {
        if ($(e).parent().parent().find(".gradeInput").val()==''){
            toast("考生成绩不可为空",'danger');
            return;
        }

        $.ajax({
            url: '/grade/updateGrade?PAGE_FROM_TYPE=BACK',
            type: "post",
            dataType: "json",
            contentType: "application/json",
            data: JSON.stringify({
                "id":$(e).attr("data"),
                "grade":$(e).parent().parent().find(".gradeInput").val(),
                "status":1

            }),
            cache: false,
            async: false,
            success: function (examList) {
                console.log(examList);
                toast("成绩修改成功","success");
                $(e).parent().parent().find(".gradeInput").addClass("d-none");
                $(e).parent().parent().find(".gradeInput").next().removeClass("d-none");
                $(e).prev().removeClass("d-none");
                $(e).addClass("d-none");
            }, error: function (data) {

            }

        });


    }
    
    var vm = new Vue({
        el: "#app",
        data: {
            isDone:false,
            userId:$("#userId").attr("data"),
            nowchooseExam:{
                examRoomList:[],
            },
            nowchooseRoom:0,
            chooseGradeIndex:0,
            exam: {
                exams: [],
                page: {
                    showtext: null,
                    keyPage: 1,
                    active_paper: 1,
                    exam_search: null,
                    page_size: 10,
                    all_page: 1
                }
            },
            examiness:{
                examinesses:[],
                page: {
                    showtext: null,
                    keyPage: 1,
                    active_paper: 1,
                    examiness_search: null,
                    page_size: 10,
                    all_page: 1
                }
            },


            file_links:[],
            NowEditExamInfo: {
                id: 0
            },
            arrangeMessage: [{
                examRoom: {
                    no: null,
                    roomName: null,
                },
                gradeList: [],
                invigilatorList: [
                    {
                        realName:null
                    }
                ],
                reviewer: {
                    realName:null
                }
            }],
        },
        methods: {
            getAllStdTicket(value){
                window.open("/exam/getAllStdTicket?examRoomId="+value,"_blank")
            },
            openExamDetail(value) {
                var _this = this;
                this.NowEditExamInfo = value;
                $.ajax({
                    url: '/examFiles/getFilesList?PAGE_FROM_TYPE=BACK',
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        page: 1,
                        size: 1000,
                        examNews: {
                            examId: this.NowEditExamInfo.id
                        }
                    }),
                    success: function (examList) {
                        console.log(examList);
                        _this.file_links = examList.data;
                    }, error: function (data) {
                    }
                });


                $.ajax({
                    url: '/examRelatedPeople/getExamArrangeInfo?PAGE_FROM_TYPE=BACK',
                    type: "post",
                    dataType: "json",
                    data: {examId: this.NowEditExamInfo.id},
                    success: function (examList) {
                        console.log(examList);
                        _this.arrangeMessage = examList.data;
                    }, error: function (data) {
                    }
                });

            },
            loadexaminesss(){
                let _this = this;
                $.ajax({
                    url: '/grade/getGradeList?PAGE_FROM_TYPE=BACK',
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        "page": _this.examiness.page.active_paper,
                        "size": _this.examiness.page.page_size,
                        "grade":{
                            examId:_this.nowchooseExam.id,
                            examRoomId:_this.nowchooseRoom,
                            ticketNumber:_this.examiness.examinesses.examiness_search
                        }

                    }),
                    cache: false,
                    async: false,
                    success: function (examList) {
                        console.log(examList);
                        _this.examiness.examinesses = examList.data;
                        if (parseInt(examList.count) % _this.examiness.page.page_size == 0) {
                            _this.examiness.page.all_page = parseInt(examList.count / _this.examiness.page.page_size);
                        } else {
                            _this.examiness.page.all_page = parseInt(examList.count / _this.examiness.page.page_size) + 1;
                        }
                        if (_this.examiness.page.all_page==0){
                            _this.examiness.page.all_page=1;
                        }
                        _this.examiness.page.showtext = "第" + _this.examiness.page.active_paper + "页/共" + _this.examiness.page.all_page + "页";
                    }, error: function (data) {

                    }

                });
            },

            changeRoom(){
                this.loadexaminesss();
            },
            chooseExam(index){
                this.nowchooseExam=this.exam.exams[index];
                this.nowchooseRoom=this.exam.exams[index].examRoomList[0].id;
                this.loadexaminesss();
            },

            examinessPrevStart() {
                this.examiness.page.active_paper = 1;
                this.examiness.page.keyPage = this.examiness.page.active_paper;
                //change(this.page.active_paper);
                $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页");
                this.loadexaminesss();
            },
            examinessNextTop() {
                this.examiness.page.active_paper = this.examiness.page.all_page;
                this.examiness.page.keyPage = this.examiness.page.active_paper;
                //change(this.page.active_paper);
                $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页");
                this.loadexaminesss();
            },
            examinessNext() {
                if (this.examiness.page.active_paper == this.examiness.page.all_page) {
                    console.log("当前页：" + this.examiness.page.active_paper + "，无法继续点击");
                    return false; //如果大于总页数就禁用下一页
                } else {
                    $("#examinessPage").text(++this.examiness.page.active_paper); //点击下一页的时候当前页数的值就加1
                    this.examiness.page.keyPage = this.examiness.page.active_paper;
                    //change(this.page.active_paper);
                    $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页");
                }
                this.loadexaminesss();
            },
            examinessPrev() {
                if (this.examiness.page.active_paper == 1) {
                    console.log("当前页：" + this.examiness.page.active_paper + "，无法继续点击");
                    return false;
                } else {
                    $("#examinessPage").text(--this.examiness.page.active_paper);
                    this.examiness.page.keyPage = this.examiness.page.active_paper;
                    //change(this.page.active_paper);
                    $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页");
                }
                this.loadexaminesss();
            },
            examinessPageFocus() {
                $("#examinessPage").val(this.examiness.page.active_paper).select();
            },
            examinessPageFocusOut() {
                this.examiness.page.keyPage = parseInt($("#examinessPage").val());
                if (this.examiness.page.keyPage > this.examiness.page.all_page | this.examiness.page.keyPage < 0 | isNaN(this.examiness.page.keyPage)) {
                    $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页")
                } else {
                    this.examiness.page.active_paper = this.examiness.page.keyPage;

                    $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页")
                }
                this.loadexaminesss();
            },
            examinessPageKeyUp() {
                let key = event.keyCode;
                if (key == 13) {
                    this.examiness.page.keyPage = parseInt($("#examinessPage").val());
                    if (this.examiness.page.keyPage > this.examiness.page.all_page | this.examiness.page.keyPage < 0 | isNaN(this.examiness.page.keyPage)) {
                        $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页")
                    } else {
                        this.examiness.page.active_paper = this.examiness.page.keyPage;
                        $("#examinessPage").val("第" + this.examiness.page.active_paper + "页/共" + this.examiness.page.all_page + "页")
                        this.loadexaminesss();
                    }
                }
            },





            examPrevStart() {
                this.exam.page.active_paper = 1;
                this.exam.page.keyPage = this.exam.page.active_paper;
                //change(this.page.active_paper);
                $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页");
                this.loadExams();
            },
            examNextTop() {
                this.exam.page.active_paper = this.exam.page.all_page;
                this.exam.page.keyPage = this.exam.page.active_paper;
                //change(this.page.active_paper);
                $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页");
                this.loadExams();
            },
            examNext() {
                if (this.exam.page.active_paper == this.exam.page.all_page) {
                    console.log("当前页：" + this.exam.page.active_paper + "，无法继续点击");
                    return false; //如果大于总页数就禁用下一页
                } else {
                    $("#examPage").text(++this.exam.page.active_paper); //点击下一页的时候当前页数的值就加1
                    this.exam.page.keyPage = this.exam.page.active_paper;
                    //change(this.page.active_paper);
                    $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页");
                }
                this.loadExams();
            },
            examPrev() {
                if (this.exam.page.active_paper == 1) {
                    console.log("当前页：" + this.exam.page.active_paper + "，无法继续点击");
                    return false;
                } else {
                    $("#examPage").text(--this.exam.page.active_paper);
                    this.exam.page.keyPage = this.exam.page.active_paper;
                    //change(this.page.active_paper);
                    $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页");
                }
                this.loadExams();
            },
            examPageFocus() {
                $("#examPage").val(this.exam.page.active_paper).select();
            },
            examPageFocusOut() {
                this.exam.page.keyPage = parseInt($("#examPage").val());
                if (this.exam.page.keyPage > this.exam.page.all_page | this.exam.page.keyPage < 0 | isNaN(this.exam.page.keyPage)) {
                    $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页")
                } else {
                    this.exam.page.active_paper = this.exam.page.keyPage;

                    $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页")
                }
                this.loadExams();
            },
            examPageKeyUp() {
                let key = event.keyCode;
                if (key == 13) {
                    this.exam.page.keyPage = parseInt($("#examPage").val());
                    if (this.exam.page.keyPage > this.exam.page.all_page | this.exam.page.keyPage < 0 | isNaN(this.exam.page.keyPage)) {
                        $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页")
                    } else {
                        this.exam.page.active_paper = this.exam.page.keyPage;
                        $("#examPage").val("第" + this.exam.page.active_paper + "页/共" + this.exam.page.all_page + "页")
                        this.loadExams();
                    }
                }
            },
            loadExams() {

                let _this = this;
                $.ajax({
                    url: '/examRelatedPeople/getReviewerExamListVo?PAGE_FROM_TYPE=BACK',
                    type: "post",
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        "page": _this.exam.page.active_paper,
                        "size": _this.exam.page.page_size,
                        "reviewerExam":{
                            reviewerId:_this.userId
                        }

                    }),
                    cache: false,
                    async: false,
                    success: function (examList) {
                        console.log(examList);
                        _this.exam.exams = examList.data;
                        if (parseInt(examList.count) % _this.exam.page.page_size == 0) {
                            _this.exam.page.all_page = parseInt(examList.count / _this.exam.page.page_size);
                        } else {
                            _this.exam.page.all_page = parseInt(examList.count / _this.exam.page.page_size) + 1;
                        }
                        if (_this.exam.page.all_page==0){
                            _this.exam.page.all_page=1;
                        }

                        _this.exam.page.showtext = "第" + _this.exam.page.active_paper + "页/共" + _this.exam.page.all_page + "页";
                    }, error: function (data) {

                    }

                });

            },

        },
        created(){
            this.loadExams();
        },
        filters: {
            examStatus(value) {
                if (value == "000") {
                    return "考场安排中"
                }
                if (value == "001") {
                    return "监考安排中"
                }
                if (value == "011") {
                    return "阅卷安排中"
                }
                if (value == "111") {
                    return "安排完成"
                }
                if (value == "101") {
                    return "阅卷安排中";
                }
                if (value === "0") {
                    return "考试报名未开始"
                }
                if (value === "1") {
                    return "正在报名"
                }
                if (value === "4") {
                    return "考试安排结束"
                }
                if (value === "5") {
                    return "准考证发布"
                }
                if (value === "6") {
                    return "考试进行中"
                }
                if (value === "7") {
                    return "考试结束"
                }
                if (value === "8") {
                    return "阅卷中"
                }
                if (value === "9") {
                    return "阅卷结束"
                }
                if (value === "10") {
                    return "成绩公布"
                }
            }
        }
    });


</script>

</body>
</html>
